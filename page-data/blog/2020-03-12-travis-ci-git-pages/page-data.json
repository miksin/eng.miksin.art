{"componentChunkName":"component---src-templates-blog-template-js","path":"/blog/2020-03-12-travis-ci-git-pages","result":{"data":{"site":{"siteMetadata":{"title":"Miksin","subtitles":["Hello! I am Miksin","I'm a Software Engineer","I'm Painting","I'm Programming","I come from TAIWAN"],"description":"Software Engineer","author":"Miksin","links":[{"name":"Home","path":"/"},{"name":"About","path":"/about"},{"name":"Blog","path":"/blog"},{"name":"Gallery","path":"/gallery"}],"socialLinks":[{"name":"github","link":"https://github.com/miksin"},{"name":"twitter","link":"https://twitter.com/miksin_"},{"name":"instagram","link":"https://www.instagram.com/miksin_/"},{"name":"pixiv","link":"https://pixiv.me/miksin"},{"name":"youtube","link":"https://www.youtube.com/channel/UCmYleBoaTtNtPVZkaUwFxOw"}]}},"page":{"html":"<h2>前言</h2>\n<p>GitHub Pages 是個好用且免費的靜態網站空間，只要把你的靜態網站檔案 push 到 gh-pages 這條 branch 就會自動產生靜態網頁。\n不過現在幾個流行的前端框架並不是直接就是靜態網頁需要的形式，還需要透過 build 來產生。\n因此如果每次 push 上主要開發用的 branch 後，自動在 gh-pages 裡產生靜態網頁檔案就會方便許多了。</p>\n<h2>開始使用 Travis CI</h2>\n<p>Travis CI 使一個可以與 Github 的 public repository 連動，並自動部署的基本免費服務。\n使用這個服務只要做一些簡單的設定即可達成我們要的功能。</p>\n<p>首先到<a href=\"https://travis-ci.com/\">Travis CI</a>的官方網站直接點選「Sign up with GitHub」註冊一個帳號。</p>\n<p>點選右上方頭像點選「settings」進入設定畫面。然後 Sync Account 並 Activate。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c42d674d1a1c2d525cdb079ec05fc476/2e661/travis-ci-setting-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.572271386430685%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABf0lEQVQoz31Sy07DMBDM9/MRXBEfgPgDbhyoQCq9VaI0jtu8ajsPJxlm3bqUULA08vqxs7uzm1jn0LYtpmnCBHyDZz8MaJoG1hh474HTveDSvkSS1TX2xqKhg20buLqEczaQjiQs8hxlWZ4J44qk85Xcvi1x8/yCp/UasAf4xmEcx+DgSNL5AQOJB9p916Hv+3D+M8NlqrDYfEJVFSYSjeHj8XPRtKgpR0M4wrL8lqRCLu8SeI7EsmRLMs+PHXFZimk7pNRPWwdNrbcHA9f7EHGYEZ0zzIsCe+pUcDd0lgZFvay1yMscFQNWVYky7DVqJnG8q4K+0Ra/RLroGF12IRNEjTrLUnODnd4jzTJkaQpFZLSVUgFiSyIC0Te51qlY9qte4X71CFUrMComU1Pn4df4/OjytU6N0xgeF9kSd+8P2O44AV2PniVJ9v60R1sg+ss5uZZdjOwqlqIr6GyHj80GWusfpaYiwck+a/gfoeWAF2yGMYeg8XxEJKNoR98vsFxYJ+8bDfIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-ci-setting-1.png\"\n        title=\"travis-ci-setting-1.png\"\n        src=\"/static/c42d674d1a1c2d525cdb079ec05fc476/6ff5e/travis-ci-setting-1.png\"\n        srcset=\"/static/c42d674d1a1c2d525cdb079ec05fc476/135ae/travis-ci-setting-1.png 300w,\n/static/c42d674d1a1c2d525cdb079ec05fc476/34e8a/travis-ci-setting-1.png 600w,\n/static/c42d674d1a1c2d525cdb079ec05fc476/6ff5e/travis-ci-setting-1.png 1200w,\n/static/c42d674d1a1c2d525cdb079ec05fc476/79a4a/travis-ci-setting-1.png 1800w,\n/static/c42d674d1a1c2d525cdb079ec05fc476/2e661/travis-ci-setting-1.png 2034w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>成功後就可以看見自己現在 GitHub 帳號中有的 repositories 了。</p>\n<h2>取得 GitHub Access Token</h2>\n<p>在開始設定自動部署前，還需要先在 GitHub 拿到存取用的 access token 才行。\n我們直接到<a href=\"https://github.com/settings/tokens\">Personal access tokens</a>的頁面並點選「Generate new token」。</p>\n<p>參考 Travis CI 的<a href=\"https://docs.travis-ci.com/user/deployment/pages/\">教學</a>，我們至少需要「public_repo」這項權限，勾選他吧！\n詳細權限設定的部分可以參考<a href=\"https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/\">這裡</a>。</p>\n<p>然後按下「Generate token」即可產生，這個 token 只會顯示這一次而已，要自己記好。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/229cf51739b16e1f47deb4321c61e171/8e846/github-access-token-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACTUlEQVQoz42S3UsUURiH90JFdNU7FdrANnGVVlMDu6+8MIKgGyECo24Dw6j7gihIoQ8woSgiuumvcN0tKg3CiyzTpDZ39suZ2Zl1dmb24+mcs+pldODh/f3eOe875yuQ0tKkMxm0dAapdcPgX6NarYn5ObZTaVKiRjcLFLN57EyecrlMwLIK2JaFVShQEBRtG9/z8Dz3ANfzcbwq5UoVajVc16VUKil836cifFlQq1UJaDkTLWewndVJZQ2lU3tekdlBMxySRgXdqeJWUIj+Kjp+DaeMoiJWH1jbgZ82fNdhLV/na67uf5gCcQJfkiVWtmw+bdp82LD4KOL7dZPVPx7rYu43OV/UFV2xwruzj7hzf46H8894+eYtCy9eM//8FXNPFrh9b5YHj5+yoWXRxZZyu7vkHUch9Y7YsiGORLeKCr9SIXD+wjkmzo5z5eoUN2/NMH39GjM3ppm6fImJiXEmL07yeW2VvJ1C03+TNpIHSK+JuP1rEy25hV8VlxIdHGTs5BgjIyNEo1Gig1GOiTh0fIjRE6MMDw8T6eujv7+fPhEVkQiRPQYGBgj39nLqzGkscbkBMdins7NTFYbDYUKhkIo9PUeEPkx3dzeHDoWE71FN5AJaW4MHtV1dXZimWW/Y1NRIQ0MDLS0ttLe309HRQTAYpK2tTXmpm5ubVZR+Py9zjY2NquFR8XP57AKxpSUSiQTxeIIloaVfjMXqOiaROi6+x1VOfpP5xb18IvFOxeXllfrDLpVcHNfDKIEpKLhguXUt0R0QT+2/x1/BPJb5pb/y8AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"github-access-token-1.png\"\n        title=\"github-access-token-1.png\"\n        src=\"/static/229cf51739b16e1f47deb4321c61e171/6ff5e/github-access-token-1.png\"\n        srcset=\"/static/229cf51739b16e1f47deb4321c61e171/135ae/github-access-token-1.png 300w,\n/static/229cf51739b16e1f47deb4321c61e171/34e8a/github-access-token-1.png 600w,\n/static/229cf51739b16e1f47deb4321c61e171/6ff5e/github-access-token-1.png 1200w,\n/static/229cf51739b16e1f47deb4321c61e171/8e846/github-access-token-1.png 1500w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>設定.travis.yml</h2>\n<p>然後我們需要在 repository 中放置一個名為<code class=\"language-text\">.travis.yml</code>的檔案來定義我們希望 Travis CI 幫我們做的事以及環境等。</p>\n<p>這裡我提供一個我的 Vue 專案的範例：</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">language</span><span class=\"token punctuation\">:</span> node_js <span class=\"token comment\"># 指定語言為node.js 10</span>\n<span class=\"token key atrule\">node_js</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token string\">\"10\"</span>\n\n<span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">yarn</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">directories</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"node_modules\"</span>\n\n<span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">only</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> master <span class=\"token comment\"># 指定當master branch發生變動時才觸發</span>\n\n<span class=\"token comment\"># 定義觸發後的行為，還有其他像是before_install等callback</span>\n<span class=\"token key atrule\">install</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> yarn install\n  <span class=\"token punctuation\">-</span> yarn run build\n\n<span class=\"token key atrule\">script</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> echo \"Skipping tests\"\n\n<span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span> pages\n  <span class=\"token key atrule\">skip-cleanup</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token key atrule\">github-token</span><span class=\"token punctuation\">:</span> $GITHUB_ACCESS_TOKEN <span class=\"token comment\"># 這裏到時候會在環境設定我們在GitHub拿到的Access Token</span>\n  <span class=\"token key atrule\">target-branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages <span class=\"token comment\"># 把build出來的檔案push進GitHub Pages用的branch</span>\n  <span class=\"token key atrule\">local-dir</span><span class=\"token punctuation\">:</span> dist <span class=\"token comment\"># Vue專案預設build到的資料夾，當然這是可以更動的</span>\n  <span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> master</code></pre></div>\n<p>更多設定可以參考官方的<a href=\"https://docs.travis-ci.com/user/customizing-the-build\">Customizing the Build</a>。</p>\n<h2>設定環境變數與啟動自動部署</h2>\n<p>回到 Travis CI 的 <a href=\"https://travis-ci.org/account/repositories\">repo 一覽</a>，\n把想要自動部署的 repo 的開關打開，並進入 Settings 來設定環境變數。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b5cba680514674759c12ee1c225a51e1/23749/travis-ci-setting-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.30434782608695%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7ElEQVQ4y6WUyYoaURSGrxPuRHduBBXcCILDG4iguG/yED5poDcZwNjBRdMdyqSJ1mzNf85/k2oMJDbVfeGvc8evzjl3UEmaIopjuK4Lx3G0oigCS5ZlKFpUkiQ4BwEOh4OWYRgIpP1qYF7xfR+E5yWH0RaRigTiSYixNBjq+XwuDPkL6EQxHl0PlsCiMITneXhLUQScTiecTFPLtCyYYo/Sdzwedd22bVjSz3lWPi5jeZuWfcy9ymSXIcrSBJmEnzKPf/pYj+UEMLfJRZ32UqFERnFM2RLqg+Piu2yK4fn4IfZR2veWDTMIi4ccyh8sCdsVkCPyBeKHETz+9cK7f0qioE0ZDesilXCRKJWQaQsVzwHMn+Bhy54MpLJeMZGbzQbz+Rzr9Rqr1QrL5fK/4vhiscC7mxu8//gBu4Oh2a7xDYFEqHd5MBhAKVVIlXIJt58+40nSQ890ugjkZzab6Um1Wg2VSuWqqtWqnttqtfD17g6ZwPgW+OKYPjYEjsdjPalcLr/oWalU0rbRaODLbvd8dPi48JZp4GQyeRVwJ8D8XHqXHk6n0995kZC44JrynzabTQ3MPeRtIlQDh8Nh4U2p1+vYbrfPQHK0h6TyuLTbbfT7fXS73avq9XrodDoYjUbY7/f6yhHIh5nQX9KzUQcGBtZkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-ci-setting-2.png\"\n        title=\"travis-ci-setting-2.png\"\n        src=\"/static/b5cba680514674759c12ee1c225a51e1/6ff5e/travis-ci-setting-2.png\"\n        srcset=\"/static/b5cba680514674759c12ee1c225a51e1/135ae/travis-ci-setting-2.png 300w,\n/static/b5cba680514674759c12ee1c225a51e1/34e8a/travis-ci-setting-2.png 600w,\n/static/b5cba680514674759c12ee1c225a51e1/6ff5e/travis-ci-setting-2.png 1200w,\n/static/b5cba680514674759c12ee1c225a51e1/23749/travis-ci-setting-2.png 1334w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>在設定頁面我們需要把剛才在 GitHub 拿到的 Access Token 設定在環境變數中，變數名要與 travis.yml 中設定的相同。\n這是為了避免 token 直接寫在檔案裡會被公開的疑慮，所以這裏設定環境變數時也記得不要將它顯示出來。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1200px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3b06ba9f502d207bd5ff01f46b174d99/e877c/travis-ci-setting-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.104454685099846%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABGUlEQVQY042QTUoEMRCFczFXrhTBC4h4Aw8guJABl8KAC0VUvIArEWVmL57AnSJMYv+MJt2dv850P1MZG0RmYeCjXhVJVeUxaQ3mWkMaA9f6SAsfljjvU816hxAC/nNYXVWQn1+gqJsGuqpRiA+8v76Bcw4hBPiMY16WkFJCKQUTh69Cx8VYvn+B2fohxOYI2fYxit0xsr0xxM4J+MYR+NYIfO0A+c0EualQZjnquk40cYFBEzSM1bdPkKf3kGcPCXU5gbqeorqaLvPzR8jxHarnFyhnoOKWw0bUkKK1NkGaLeK/wy/aH8KKGKK/9NBHb8lT0n+9ZU4bdG1I9GGB4Dy8sUkPNcot3et79JGu61IjgppTTv4WRYFvukrA5gWjp9YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"travis-ci-setting-3.png\"\n        title=\"travis-ci-setting-3.png\"\n        src=\"/static/3b06ba9f502d207bd5ff01f46b174d99/6ff5e/travis-ci-setting-3.png\"\n        srcset=\"/static/3b06ba9f502d207bd5ff01f46b174d99/135ae/travis-ci-setting-3.png 300w,\n/static/3b06ba9f502d207bd5ff01f46b174d99/34e8a/travis-ci-setting-3.png 600w,\n/static/3b06ba9f502d207bd5ff01f46b174d99/6ff5e/travis-ci-setting-3.png 1200w,\n/static/3b06ba9f502d207bd5ff01f46b174d99/79a4a/travis-ci-setting-3.png 1800w,\n/static/3b06ba9f502d207bd5ff01f46b174d99/2fb56/travis-ci-setting-3.png 2400w,\n/static/3b06ba9f502d207bd5ff01f46b174d99/e877c/travis-ci-setting-3.png 2604w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>然後嘗試 push 新的 commit 到 master branch 或是手動點選「Trigger build」看看是不是如預期的動作囉！</p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://travis-ci.com/\">Travis CI</a></li>\n<li><a href=\"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line\">Creating a personal access token for the command line</a></li>\n<li><a href=\"https://docs.travis-ci.com/user/deployment/pages/\">GitHub Pages Deployment</a></li>\n<li><a href=\"https://developer.github.com/apps/building-oauth-apps/understanding-scopes-for-oauth-apps/\">Understanding scopes for OAuth Apps</a></li>\n<li><a href=\"https://docs.travis-ci.com/user/customizing-the-build\">Customizing the Build</a></li>\n</ul>","frontmatter":{"date":"March 12, 2020","path":"/blog/2020-03-12-travis-ci-git-pages","title":"使用Travis CI自動部署靜態網頁到GitHub Pages","tags":["git","ci","travis-ci","github"]}}},"pageContext":{"next":{"frontmatter":{"path":"/gallery/2020-03-24-kyouko","title":"響子"}},"prev":{"frontmatter":{"path":"/gallery/2020-03-04-iris","title":"Iris"}}}},"staticQueryHashes":["63159454"]}