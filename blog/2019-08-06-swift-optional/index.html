<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.26.0"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Optional in Swift | Miksin</title><meta data-react-helmet="true" name="description" content="Software Engineer"/><meta data-react-helmet="true" property="og:title" content="Optional in Swift"/><meta data-react-helmet="true" property="og:description" content="Software Engineer"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Miksin"/><meta data-react-helmet="true" name="twitter:title" content="Optional in Swift"/><meta data-react-helmet="true" name="twitter:description" content="Software Engineer"/><style data-styled="" data-styled-version="5.0.0">.elJmwq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.efWXhI{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
.eXpeIK{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}
.jEZhmc{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}
data-styled.g1[id="FlexBox__Wrapper-sc-1a1ax0-0"]{content:"elJmwq,efWXhI,eXpeIK,jEZhmc,"}
.gIVTds{width:100vw;height:100vh;left:0;right:0;top:0;bottom:0;position:fixed;z-index:25;background:linear-gradient(to left,#03a9f4,#03a9f4);-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%);-webkit-transition:-webkit-transform 0.25s ease;-webkit-transition:transform 0.25s ease;transition:transform 0.25s ease;}
.gIVTds.active{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);}
data-styled.g3[id="ScreenWrapper__Wrapper-lhzvs5-0"]{content:"gIVTds,"}
.hqWhKG{outline:none;border:none;background:transparent;padding:0;margin:0;cursor:pointer;font-size:1rem;padding:5.6000000000000005px;background:transparent;border-radius:50%;}
data-styled.g5[id="IconButton__Btn-sc-1dpa1iz-0"]{content:"hqWhKG,"}
.fACLcD{max-width:480px;width:100%;height:100%;margin:auto;}
data-styled.g6[id="NavMenu__Wrapper-sc-1cinn8h-0"]{content:"fACLcD,"}
.cKrNJE{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;width:100%;}
data-styled.g7[id="NavMenu__RestPadding-sc-1cinn8h-1"]{content:"cKrNJE,"}
.jnsHJp{margin:auto;padding-top:54px;width:100%;position:relative;}
.jnsHJp.active > div{-webkit-animation-name:dZWjwz;animation-name:dZWjwz;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-timing-function:steps(20,end);animation-timing-function:steps(20,end);-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}
.jnsHJp.active > div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s;}
.jnsHJp.active > div:nth-child(2){-webkit-animation-delay:0.25s;animation-delay:0.25s;}
.jnsHJp.active > div:nth-child(3){-webkit-animation-delay:0.5s;animation-delay:0.5s;}
.jnsHJp.active > div:nth-child(4){-webkit-animation-delay:0.75s;animation-delay:0.75s;}
data-styled.g8[id="NavMenu__MenuList-sc-1cinn8h-2"]{content:"jnsHJp,"}
.dmjRZp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:0%;overflow:hidden;}
.dmjRZp:hover{background:linear-gradient(to left,transparent,rgba(255,255,255,.2),transparent);}
data-styled.g9[id="NavMenu__MenuItem-sc-1cinn8h-3"]{content:"dmjRZp,"}
.joHSCl{padding:8px 0;margin:auto;text-align:center;font-size:27px;-webkit-text-decoration:none;text-decoration:none;color:#FFFFFF;white-space:nowrap;}
data-styled.g10[id="NavMenu__MenuLink-sc-1cinn8h-4"]{content:"joHSCl,"}
.kpVRSI.active{-webkit-animation-name:hrftdn;animation-name:hrftdn;-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-timing-function:cubic-bezier(0,.68,1,.59);animation-timing-function:cubic-bezier(0,.68,1,.59);-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;}
data-styled.g11[id="NavMenu__CloseButton-sc-1cinn8h-5"]{content:"kpVRSI,"}
.kkvxxk{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}
data-styled.g12[id="FlexPad-sc-1k4qgli-0"]{content:"kkvxxk,"}
.cpbBhS{position:fixed;width:100%;height:72px;background-color:rgba(255,255,255,0.7);z-index:20;}
@media screen and (max-width:480px){.cpbBhS{height:54px;}}
data-styled.g13[id="Nav__Fixed-sc-11rjgpp-0"]{content:"cpbBhS,"}
.kIujkv{margin:auto;width:100%;height:100%;max-width:1024px;}
data-styled.g14[id="Nav__Wrapper-sc-11rjgpp-1"]{content:"kIujkv,"}
.bxdYXQ{margin:auto 8px;width:54px;height:54px;}
@media screen and (max-width:480px){.bxdYXQ{width:42px;height:42px;}}
data-styled.g15[id="Nav__MenuButton-sc-11rjgpp-2"]{content:"bxdYXQ,"}
.dXLWba{width:100%;height:72px;}
@media screen and (max-width:480px){.dXLWba{height:54px;}}
data-styled.g16[id="TopPad-n3up42-0"]{content:"dXLWba,"}
.laNXhk{background-color:#03a9f4;color:#FFFFFF;padding:4px 10px;border-radius:13px;text-align:center;box-shadow:1px 1px 5px 0px rgba(0,0,0,.3);}
.laNXhk > .name{font-size:18px;line-height:20px;white-space:nowrap;}
.laNXhk > .number{background-color:rgba(66,66,66,0.5);border-radius:10px;font-size:14px;min-width:20px;height:20px;line-height:20px;text-align:center;}
data-styled.g42[id="Tag__Base-suqqo6-0"]{content:"laNXhk,"}
.fZqWod{width:100%;max-width:768px;margin:0 auto;padding:12px;}
data-styled.g88[id="blogTemplate__Wrapper-sc-1iw0vk6-1"]{content:"fZqWod,"}
.dqznRf{width:100%;padding:12px;}
data-styled.g89[id="blogTemplate__Frontmatter-sc-1iw0vk6-2"]{content:"dqznRf,"}
.eJLgoH{width:100%;padding:12px;}
.eJLgoH a{font-weight:700 !important;color:inherit !important;}
data-styled.g92[id="blogTemplate__Content-sc-1iw0vk6-5"]{content:"eJLgoH,"}
.izhIIQ{width:100%;margin:12px auto;border-top:1px solid #424242;}
data-styled.g93[id="blogTemplate__Comment-sc-1iw0vk6-6"]{content:"izhIIQ,"}
@-webkit-keyframes dZWjwz{from{width:0%;}to{width:100%;}}
@keyframes dZWjwz{from{width:0%;}to{width:100%;}}
data-styled.g95[id="sc-keyframes-dZWjwz"]{content:"dZWjwz,"}
@-webkit-keyframes hrftdn{0%{-webkit-transform:rotate(0deg) scale(1) translateY(0);-ms-transform:rotate(0deg) scale(1) translateY(0);transform:rotate(0deg) scale(1) translateY(0);}50%{-webkit-transform:rotate(180deg) scale(0.9) translateY(10%);-ms-transform:rotate(180deg) scale(0.9) translateY(10%);transform:rotate(180deg) scale(0.9) translateY(10%);}100%{-webkit-transform:rotate(360deg) scale(1) translateY(0);-ms-transform:rotate(360deg) scale(1) translateY(0);transform:rotate(360deg) scale(1) translateY(0);}}
@keyframes hrftdn{0%{-webkit-transform:rotate(0deg) scale(1) translateY(0);-ms-transform:rotate(0deg) scale(1) translateY(0);transform:rotate(0deg) scale(1) translateY(0);}50%{-webkit-transform:rotate(180deg) scale(0.9) translateY(10%);-ms-transform:rotate(180deg) scale(0.9) translateY(10%);transform:rotate(180deg) scale(0.9) translateY(10%);}100%{-webkit-transform:rotate(360deg) scale(1) translateY(0);-ms-transform:rotate(360deg) scale(1) translateY(0);transform:rotate(360deg) scale(1) translateY(0);}}
data-styled.g96[id="sc-keyframes-hrftdn"]{content:"hrftdn,"}
</style><link rel="icon" href="/icons/icon-48x48.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#A5CD6C"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e342f90d083b1b3731d53522093d79b6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e342f90d083b1b3731d53522093d79b6"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-343c385e402c7044f6f4.js"/><link as="script" rel="preload" href="/framework-19dd447402be9c032106.js"/><link as="script" rel="preload" href="/app-947695876b520e8c6c0b.js"/><link as="script" rel="preload" href="/commons-fb0af27078790ad38b98.js"/><link as="script" rel="preload" href="/ed4b0a56400bd545707190e3dd88e5b5598b6a6e-124abe6259510da7f280.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-22201a3aad45f715eef7.js"/><link as="fetch" rel="preload" href="/page-data/blog/2019-08-06-swift-optional/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC:400,700&amp;display=swap" rel="stylesheet"/><link href="/loader.css" rel="stylesheet"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___loader"><div class="typewriter"><h1 class="text"></h1><h1 class="cursor"></h1></div></div><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div color="rgba(255, 255, 255, 0.7)" class="FlexBox__Wrapper-sc-1a1ax0-0 elJmwq Nav__Fixed-sc-11rjgpp-0 cpbBhS" wrap="nowrap" dir="row "><div class="FlexBox__Wrapper-sc-1a1ax0-0 elJmwq Nav__Wrapper-sc-11rjgpp-1 kIujkv" wrap="nowrap" dir="row "><div class="FlexPad-sc-1k4qgli-0 kkvxxk"></div><button class="BaseButton-frxe0f-0 IconButton__Btn-sc-1dpa1iz-0 hqWhKG Nav__MenuButton-sc-11rjgpp-2 bxdYXQ"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="#03a9f4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button></div></div><div class="ScreenWrapper__Wrapper-lhzvs5-0 gIVTds"><div class="FlexBox__Wrapper-sc-1a1ax0-0 efWXhI NavMenu__Wrapper-sc-1cinn8h-0 fACLcD" wrap="nowrap" dir="column "><div class="FlexBox__Wrapper-sc-1a1ax0-0 efWXhI NavMenu__MenuList-sc-1cinn8h-2 jnsHJp" wrap="nowrap" dir="column "><div class="FlexBox__Wrapper-sc-1a1ax0-0 eXpeIK NavMenu__MenuItem-sc-1cinn8h-3 dmjRZp" wrap="nowrap" dir="row "><a class="NavMenu__MenuLink-sc-1cinn8h-4 joHSCl" href="/">Home</a></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 eXpeIK NavMenu__MenuItem-sc-1cinn8h-3 dmjRZp" wrap="nowrap" dir="row "><a class="NavMenu__MenuLink-sc-1cinn8h-4 joHSCl" href="/about">About</a></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 eXpeIK NavMenu__MenuItem-sc-1cinn8h-3 dmjRZp" wrap="nowrap" dir="row "><a class="NavMenu__MenuLink-sc-1cinn8h-4 joHSCl" href="/blog">Blog</a></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 eXpeIK NavMenu__MenuItem-sc-1cinn8h-3 dmjRZp" wrap="nowrap" dir="row "><a class="NavMenu__MenuLink-sc-1cinn8h-4 joHSCl" href="/gallery">Gallery</a></div></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 elJmwq NavMenu__RestPadding-sc-1cinn8h-1 cKrNJE" wrap="nowrap" dir="row "><button class="BaseButton-frxe0f-0 IconButton__Btn-sc-1dpa1iz-0 hqWhKG NavMenu__CloseButton-sc-1cinn8h-5 kpVRSI"><svg xmlns="http://www.w3.org/2000/svg" width="54" height="54" viewBox="0 0 24 24" fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></button></div></div></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 efWXhI blogTemplate__Base-sc-1iw0vk6-0 juxfqe" wrap="nowrap" dir="column "><div class="TopPad-n3up42-0 dXLWba"></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 efWXhI blogTemplate__Wrapper-sc-1iw0vk6-1 fZqWod" wrap="nowrap" dir="column "><div class="FlexBox__Wrapper-sc-1a1ax0-0 jEZhmc blogTemplate__Frontmatter-sc-1iw0vk6-2 dqznRf" wrap="nowrap" dir="column "><h1 class="blogTemplate__Title-sc-1iw0vk6-3 dCjPls">Optional in Swift</h1><h4 class="blogTemplate__Timestamp-sc-1iw0vk6-4 gbREdv">August 06, 2019</h4><div class="FlexBox__Wrapper-sc-1a1ax0-0 eXpeIK blogTemplate__TagList-sc-1iw0vk6-7 DYKUG" wrap="nowrap" dir="row "><div class="FlexBox__Wrapper-sc-1a1ax0-0 elJmwq Tag__Base-suqqo6-0 laNXhk mg-lr-2" color="#FFFFFF" wrap="nowrap" dir="row "><span class="name">swift</span></div><div class="FlexBox__Wrapper-sc-1a1ax0-0 elJmwq Tag__Base-suqqo6-0 laNXhk mg-lr-2" color="#FFFFFF" wrap="nowrap" dir="row "><span class="name">programming</span></div></div></div><div class="blogTemplate__Content-sc-1iw0vk6-5 eJLgoH"><h2>前言</h2>
<p>我們有時候會需要讓變數有可能會是「空值」，這在每個程式語言都有可能有這個需求。
但Swift為此設計了許多配套措施，讓一切使用上變得很順暢又十分有趣，因此在這裡記下筆記。</p>
<!-- more -->
<hr>
<h2><code class="language-text">Optional</code> and <code class="language-text">nil</code></h2>
<p>前言提到我們需要讓變數可能是空值，我們這裡舉個例子來想像這個問題。</p>
<p>我想要紀錄朋友們的資訊，因此寫了一個名為 <em>Person</em> 的 class ：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span>

    <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token number">_</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> alice <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// alice</span></code></pre></div>
<p>我紀錄了一個名為 <em>alice</em> 的好友的資訊。不過可以的話除了名字之外我還想知道<del>她有沒有男朋友</del></p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token keyword">var</span> lover<span class="token punctuation">:</span> <span class="token builtin">Bool</span>

    <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token number">_</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> lover<span class="token punctuation">:</span> <span class="token builtin">Bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
        <span class="token keyword">self</span><span class="token punctuation">.</span>lover <span class="token operator">=</span> lover
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> alice <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">,</span> lover<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// alice</span>
<span class="token function">print</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>lover<span class="token punctuation">)</span> <span class="token comment">// false</span></code></pre></div>
<p>新增了一個名為lover的boolean值欄位，我只要用<code class="language-text">true</code>或<code class="language-text">false</code>來填上就行了。
但是其實這裡似乎有設計上的問題：在我新增這筆資料時，我可能還不知道她有沒有情人呀！</p>
<p>我可能今天才交了一個朋友，第一天就問這種問題也有點奇怪，所以還只能記上名字。
即便我知道答案是<code class="language-text">true</code>並一開始就紀錄了，但也是可能在某天聽聞這樣的風聲「alice好像跟學長分手了耶」，那我應該立刻將這個欄位改為<code class="language-text">false</code>嗎？果然還沒確認之前，似乎應該要是「不明」才對呢。</p>
<p><code class="language-text">Optional</code> 這樣的設計就這樣誕生了。我們可以讓一個變數有 <code class="language-text">nil</code>(空值) 存在的可能性。以剛才的例子來看即是：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">var</span> lover<span class="token punctuation">:</span> <span class="token builtin">Bool</span><span class="token operator">?</span> <span class="token comment">// default value is nil</span></code></pre></div>
<p>使用問號 <code class="language-text">?</code> 來表達這個變數是Optional，這看起來挺直觀的，畢竟就是可能有值，也可能沒有值的狀態。
在宣告完成後，由於我們沒有同時設定上initial value，這個 <em>lover</em> 就直接是 <code class="language-text">nil</code> 了：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span>
    <span class="token keyword">var</span> lover<span class="token punctuation">:</span> <span class="token builtin">Bool</span><span class="token operator">?</span>

    <span class="token keyword">init</span><span class="token punctuation">(</span><span class="token number">_</span> name<span class="token punctuation">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> alice <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">"alice"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> alice<span class="token punctuation">.</span>lover <span class="token operator">==</span> <span class="token constant">nil</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"is nil"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token comment">// is nil</span></code></pre></div>
<p>然後我們想依據<code class="language-text">lover</code>的值設定要顯示的訊息：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift">alice<span class="token punctuation">.</span>lover <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> msg <span class="token operator">=</span> alice<span class="token punctuation">.</span>lover <span class="token operator">?</span> <span class="token string">"give up"</span> <span class="token punctuation">:</span> <span class="token string">"chance"</span> <span class="token comment">// Compile Error</span>
<span class="token function">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span></code></pre></div>
<p>當我們嘗試想要讀取<code class="language-text">lover</code>時，出現了<em>Compile Error</em>，可是我們不是在前一行已經好好的賦予他一個值了嗎？</p>
<p>這算是一種安全機制，Optional的變數內容是個黑盒子，我們並不知道他的內容是什麼，Swift不允許我們在打開盒子前就讀取其內容。</p>
<hr>
<h3>Forced Wrapping <code class="language-text">!</code></h3>
<p>我們嘗試使用第一種方式打開包裝：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift">alice<span class="token punctuation">.</span>lover <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> msg <span class="token operator">=</span> alice<span class="token punctuation">.</span>lover<span class="token operator">!</span> <span class="token operator">?</span> <span class="token string">"give up"</span> <span class="token punctuation">:</span> <span class="token string">"chance"</span>
<span class="token function">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token comment">// chance</span></code></pre></div>
<p>這次沒有出現Compile Error了。我們在 <code class="language-text">alice.lover</code> 後面加上了一個驚嘆號 <code class="language-text">!</code>，這個 <code class="language-text">!</code> 代表著 <strong>forced unwrapping</strong>，意旨我們在要使用的同時強制打開包裝把裡面的東西倒出來。</p>
<p>但這樣的使用方式有個嚴重的問題，如果裡面沒有東西，也就是<code class="language-text">nil</code>的話，程式就會產生<em>Runtime Error</em>。
這是個嚴重的問題，就好比我們擅自翻閱Alice同學的聊天紀錄結果被她黑單了一樣，我們在嘗試做後續的行為之前，還是應該謹慎一點。</p>
<h3><code class="language-text">if let</code> and <code class="language-text">guard let</code></h3>
<p>我們可以用<code class="language-text">if alice.lover != nil</code>謹慎的使用<code class="language-text">if</code>來判斷這個Optional是不是<code class="language-text">nil</code>，如果不是我們再使用<code class="language-text">!</code>來打開包裝，但每次都這樣實在是有點麻煩又冗長。
而Swift提供了一些語法糖來幫助我們解決這個問題：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">if</span> <span class="token keyword">let</span> lover <span class="token operator">=</span> alice<span class="token punctuation">.</span>lover <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span>lover <span class="token operator">?</span> <span class="token string">"give up"</span> <span class="token punctuation">:</span> <span class="token string">"chance"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">/* do something */</span> <span class="token punctuation">}</span></code></pre></div>
<p>使用<code class="language-text">if let</code>的話，可以在判斷後直接賦值，相當於檢查內容後直接拿到包裝內的東西。
且這邊已賦值的<code class="language-text">lover</code>因為已經知道沒有<code class="language-text">nil</code>的可能了，並不是Optional，使用時可以不用在後面加上<code class="language-text">!</code>。</p>
<p>而在某些狀況下使用<code class="language-text">guard let</code>會更加合適：</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">func</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token number">_</span> person<span class="token punctuation">:</span> <span class="token builtin">Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">guard</span> <span class="token keyword">let</span> lover <span class="token operator">=</span> person<span class="token punctuation">.</span>lover <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>比方說這個在function中，如果我們不知道這個人到底有沒有情人，我們就不做任何事。
使用<code class="language-text">guard let</code>在檢查時直接賦值，若為<code class="language-text">nil</code>則return。
用法與<code class="language-text">if let</code>類似，但<code class="language-text">guard let</code>更適合用在提早return的場合。</p>
<h3>Nil-Coalescing Operator</h3>
<p>有時候我們遇到<code class="language-text">nil</code>時也並不是要做甚麼複雜的處理，只是準備了個預設值來使用就好，那就可以使用 <code class="language-text">??</code> 這個語法糖。</p>
<div class="gatsby-highlight" data-language="swift"><pre class="language-swift"><code class="language-swift"><span class="token keyword">let</span> lover <span class="token operator">=</span> alice<span class="token punctuation">.</span>lover <span class="token operator">?</span><span class="token operator">?</span> <span class="token boolean">false</span>
<span class="token comment">// let lover = alice.lover != nil ? alice.lover! : false</span></code></pre></div>
<p>在這個例子中，我們設定為「不知道alice有沒有男朋友，就當作沒有」來行動。這個語法就變得相當簡潔，萬一遇上<code class="language-text">nil</code>時，也早已準備好預設值而不會出現<strong>Runtime Error</strong>。</p>
<h2>總結</h2>
<p>Swift使用了Optional型態來處理<code class="language-text">nil</code>的問題，而對應的語法糖大致有以下：</p>
<ol>
<li>forced unwrapping <code class="language-text">!</code></li>
<li><code class="language-text">if let</code> and <code class="language-text">guard let</code></li>
<li>Nil-Coalescing Operator <code class="language-text">??</code></li>
</ol>
<p>另外還有這裡沒提到的<strong>Optional Chaining</strong>就再另外新增一篇筆記。</p>
<hr>
<h2>References</h2>
<ul>
<li><a href="https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html">Swift Language Guide</a></li>
<li><a href="https://www.appcoda.com.tw/swift-optional/">初學Swift：愛恨交織的 Optional - Grady Zhuo</a></li>
<li><a href="https://www.appcoda.com.tw/swift-optional-intro/">Swift的問號與驚嘆號：可有可無的 Optional - 彼得潘</a></li>
</ul></div><div class="blogTemplate__Comment-sc-1iw0vk6-6 izhIIQ"><span class="disqus-comment-count" data-disqus-identifier="/blog/2019-08-06-swift-optional">...</span><div id="disqus_thread"></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-XXXXXXXXX-X', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2019-08-06-swift-optional";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-f5ec1ff06108d0c85bab.js"],"app":["/app-947695876b520e8c6c0b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c5713cc239e7114fe6a5.js"],"component---src-pages-about-js":["/component---src-pages-about-js-ab7d22cbce5c07282227.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-221cc1b29321015c84d5.js"],"component---src-pages-gallery-js":["/component---src-pages-gallery-js-35e56239d7cc57de772d.js"],"component---src-pages-index-js":["/component---src-pages-index-js-cc98d27e2bf892d1a27d.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-22201a3aad45f715eef7.js"]};/*]]>*/</script><script src="/polyfill-f5ec1ff06108d0c85bab.js" nomodule=""></script><script src="/component---src-templates-blog-template-js-22201a3aad45f715eef7.js" async=""></script><script src="/ed4b0a56400bd545707190e3dd88e5b5598b6a6e-124abe6259510da7f280.js" async=""></script><script src="/commons-fb0af27078790ad38b98.js" async=""></script><script src="/app-947695876b520e8c6c0b.js" async=""></script><script src="/framework-19dd447402be9c032106.js" async=""></script><script src="/webpack-runtime-343c385e402c7044f6f4.js" async=""></script></body></html>